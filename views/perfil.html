<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LiliEstudio — Mi perfil</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
    <link rel="icon" type="image/x-icon" href="../img/favicon.ico" />
    <link href="../css/style.css" rel="stylesheet" />
    
    <style>
      /* Estilos puntuales de esta página */
      .avatar-lg{ width:120px; height:120px; border-radius:50%; object-fit:cover; }
      .card-section + .card-section{ margin-top:1rem; }
      .readonly-value{ color:#ddd; }
    </style>
  </head>
  <body>
    <!-- NAV -->
    <header>
      <nav class="navbar navbar-expand-lg navbar-dark bg-gradient-dark border-bottom">
        <div class="container">
          <a class="navbar-brand d-flex justify-content-sm-center justify-content-lg-start align-items-center m-auto"
             href="../index.html">
            <img src="../img/logo.png" alt="logo" class="img-fluid w-75">
          </a>
          
          <button class="navbar-toggler toogler-color" type="button" data-bs-toggle="collapse"
                  data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Abrir menú">
            <span class="navbar-toggler-icon"></span>
          </button>
          
          <div id="mainNav" class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto font-bankgothic align-items-end align-items-lg-center gap-0 gap-lg-2">
              <li class="nav-item text-center"><a class="nav-link text-light active" href="../index.html">Inicio</a></li>
              <li class="nav-item text-center"><a class="nav-link text-light" href="../views/nosotros.html">Nosotros</a></li>
              <li class="nav-item text-center"><a class="nav-link text-light" href="../views/servicios.html">Servicios</a></li>
              <li class="nav-item text-center"><a class="nav-link text-light" href="../views/contacto.html">Contacto</a></li>
              
              <!-- Acciones -->
              <li class="nav-item text-center">
                <a class="btn btn-outline-turquesa ms-0 ms-lg-2 w-100 w-lg-auto mt-2 mt-lg-0" href="../views/iniciar-sesion.html">
                  <i class="bi bi-person"></i> Iniciar Sesión
                </a>
              </li>
              <li class="nav-item text-center">
                <a class="btn btn-turquesa ms-0 ms-lg-2 w-100 w-lg-auto mt-2 mt-lg-0" href="../views/admin.html">
                  <i class="bi bi-speedometer2"></i> Admin
                </a>
              </li>
              
              <!-- Usuario -->
              <li class="nav-item dropdown ms-lg-2">
                <a class="nav-link dropdown-toggle d-flex align-items-center gap-2 text-light justify-content-center"
                   href="#" data-bs-toggle="dropdown">
                  <img src="../img/ricardo.webp" alt="Avatar" class="navbar-avatar">
                  <span  id="navUserName">Mi cuenta</span>
                </a>
                <ul class="dropdown-menu dropdown-menu-end dropdown-menu-dark shadow border-light">
                  <li>
                    <a class="dropdown-item" href="../views/perfil.html">
                      <i class="bi bi-person-circle me-2"></i> Ver perfil
                    </a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="../views/suscripcion.html">
                      <i class="bi bi-speedometer2 me-2"></i> Dashboard
                    </a>
                  </li>
                  <li><hr class="dropdown-divider"></li>
                  <li>
                    <a class="dropdown-item text-danger" href="#" id="btnLogout">
                      <i class="bi bi-box-arrow-right me-2"></i> Cerrar sesión
                    </a>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    
    </header>
    
    <!-- MAIN -->
    <main class="py-5 bg-gradient-dark text-light">
      <div class="container">
        <header class="mb-4">
          <h1 class="fs-2 font-bankgothic fw-bold mb-1">Mi perfil</h1>
          <p class="text-secondary mb-0">Consultá tus datos y editá lo que necesites.</p>
        </header>
        
        <div class="row g-4">
          <!-- Col izquierda: Avatar + Estado -->
          <div class="col-lg-4">
            <div class="card bg-dark text-light border-light card-section">
              <div class="card-body text-center">
                <img id="avatarImg" src="../img/ricardo.webp" alt="Tu avatar" class="avatar-lg mx-auto d-block mb-3 border border-secondary" />
                <div class="d-grid gap-2">
                  <label class="btn btn-outline-turquesa mb-0">
                    <i class="bi bi-image me-1"></i> Cambiar foto
                    <input id="avatarInput" type="file" accept="image/*" hidden>
                  </label>
                  <button class="btn btn-outline-light" id="btnRemoveAvatar" type="button">
                    <i class="bi bi-trash3 me-1"></i> Quitar foto
                  </button>
                </div>
              </div>
            </div>
            
            <div class="card bg-dark text-light border-light card-section">
              <div class="card-body">
                <h2 class="h6 text-secondary mb-3">Estado de la cuenta</h2>
                <ul class="list-unstyled mb-0 small">
                  <li class="d-flex align-items-center justify-content-between">
                    <span>Verificación de email</span>
                    <span class="badge text-bg-success">OK</span>
                  </li>
                  <li class="d-flex align-items-center justify-content-between mt-2">
                    <span>2FA</span>
                    <span class="badge text-bg-secondary">Pendiente</span>
                  </li>
                </ul>
                <div class="d-grid gap-2 mt-3">
                  <button class="btn btn-outline-turquesa btn-sm" data-bs-toggle="modal" data-bs-target="#modalPassword">
                    <i class="bi bi-shield-lock me-1"></i> Cambiar contraseña
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Col derecha: Ver / Editar -->
          <div class="col-lg-8">
            <div class="card bg-dark text-light border-light">
              <div class="card-body">
                <div class="d-flex align-items-center justify-content-between mb-2">
                  <h2 class="h6 text-secondary mb-0">Datos personales</h2>
                  <div class="d-flex gap-2">
                    <button id="btnEdit" class="btn btn-turquesa btn-sm"><i class="bi bi-pencil-square me-1"></i> Editar</button>
                    <button id="btnCancel" class="btn btn-outline-light btn-sm d-none">Cancelar</button>
                  </div>
                </div>
                
                <!-- Vista solo lectura -->
                <div id="profileView">
                  <div class="row g-3">
                    <div class="col-md-6">
                      <small class="text-secondary d-block">Nombre</small>
                      <div class="readonly-value" id="vNombre">Ricardo</div>
                    </div>
                    <div class="col-md-6">
                      <small class="text-secondary d-block">Apellido</small>
                      <div class="readonly-value" id="vApellido">Garcia</div>
                    </div>
                    <div class="col-md-6">
                      <small class="text-secondary d-block">Email</small>
                      <div class="readonly-value" id="vEmail">ricardo@example.com</div>
                    </div>
                    <div class="col-md-6">
                      <small class="text-secondary d-block">Teléfono</small>
                      <div class="readonly-value" id="vTelefono">+54 221 555-5555</div>
                    </div>
                    <div class="col-md-6">
                      <small class="text-secondary d-block">Ciudad</small>
                      <div class="readonly-value" id="vCiudad">La Plata</div>
                    </div>
                    <div class="col-md-6">
                      <small class="text-secondary d-block">Instagram</small>
                      <div class="readonly-value" id="vInstagram">@lilitech_laplata</div>
                    </div>
                  </div>
                </div>
                
                <!-- Form edición -->
                <form id="profileForm" class="row g-3 d-none needs-validation" novalidate>
                  <div class="col-md-6">
                    <label class="form-label" for="fNombre">Nombre</label>
                    <input id="fNombre" class="form-control" required>
                    <div class="invalid-feedback">Ingresá tu nombre.</div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label" for="fApellido">Apellido</label>
                    <input id="fApellido" class="form-control" required>
                    <div class="invalid-feedback">Ingresá tu apellido.</div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label" for="fEmail">Email</label>
                    <input id="fEmail" type="email" class="form-control" required>
                    <div class="invalid-feedback">Ingresá un email válido.</div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label" for="fTelefono">Teléfono</label>
                    <input id="fTelefono" class="form-control">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label" for="fCiudad">Ciudad</label>
                    <input id="fCiudad" class="form-control">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label" for="fInstagram">Instagram</label>
                    <input id="fInstagram" class="form-control" placeholder="@usuario">
                  </div>
                  <div class="col-12 d-grid d-sm-flex gap-3 mt-2">
                    <button class="btn btn-turquesa" type="submit">Guardar cambios</button>
                    <button class="btn btn-outline-light" type="button" id="btnCancel2">Cancelar</button>
                  </div>
                </form>
              
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    
    <!-- MODAL Cambiar contraseña -->
    <div class="modal fade" id="modalPassword" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content bg-dark text-light border-light">
          <div class="modal-header">
            <h2 class="modal-title h6">Cambiar contraseña</h2>
            <button class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <form id="passwordForm" class="modal-body needs-validation" novalidate>
            <div class="mb-3">
              <label class="form-label" for="oldPass">Contraseña actual</label>
              <input type="password" id="oldPass" class="form-control" required minlength="6">
              <div class="invalid-feedback">Ingresá tu contraseña actual.</div>
            </div>
            <div class="mb-3">
              <label class="form-label" for="newPass">Nueva contraseña</label>
              <input type="password" id="newPass" class="form-control" required minlength="6">
              <div class="invalid-feedback">Mínimo 6 caracteres.</div>
            </div>
            <div class="mb-1">
              <label class="form-label" for="newPass2">Repetir nueva contraseña</label>
              <input type="password" id="newPass2" class="form-control" required minlength="6">
              <div class="invalid-feedback">Repetí la contraseña.</div>
            </div>
            <div class="modal-footer px-0">
              <button class="btn btn-outline-light" data-bs-dismiss="modal" type="button">Cancelar</button>
              <button class="btn btn-turquesa" type="submit">Actualizar</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    
    <!-- FOOTER -->
    <footer class="py-4 bg-black border-top border-secondary">
      <div class="container">
        <div class="row g-4 align-items-center">
          <div class="col-12 col-lg-4 d-flex justify-content-center align-items-center gap-3">
            <a class="navbar-brand font-quantum pt-0 fs-2" href="../index.html">
              <img src="../img/logo.png" alt="logo" class="img-fluid w-75" />
            </a>
          </div>
          <div class="col-12 col-lg-8">
            <ul class="list-unstyled mb-0 text-secondary d-flex flex-column flex-md-row align-items-center justify-content-md-end gap-3 small">
              <li><i class="bi bi-person me-1 text-accent"></i> Ricardo Rodolfo Garcia</li>
              <li><i class="bi bi-calendar3 me-1 text-accent"></i> 37 años</li>
              <li><i class="bi bi-envelope me-1 text-accent"></i>
                <a class="link-light link-underline-opacity-0" href="mailto:ricardo.garcia@davinci.edu.ar">ricardo.garcia@davinci.edu.ar</a>
              </li>
              <li><i class="bi bi-instagram me-1 text-accent"></i>
                <a class="link-light link-underline-opacity-0" href="https://www.instagram.com/lilitech_laplata" target="_blank" rel="noopener">@lilitech_laplata</a>
              </li>
              <li><i class="bi bi-globe2 me-1 text-accent"></i>
                <a class="link-light link-underline-opacity-0" href="https://lilitech.shop/" target="_blank" rel="noopener">lilitech.shop</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    
    <div class="toast-container position-fixed bottom-0 end-0 p-3" id="toastContainer"></div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    
    <!-- Lógica mínima: toggle edición, preview avatar, guardado mock -->
    <script>
      const $ = (s) => document.querySelector(s);
      
      const view = $("#profileView");
      const form = $("#profileForm");
      const btnEdit = $("#btnEdit");
      const btnCancel = $("#btnCancel");
      const btnCancel2 = $("#btnCancel2");
      
      // Inicializar form con valores de la vista
      function loadFormFromView() {
        $("#fNombre").value = $("#vNombre").textContent.trim();
        $("#fApellido").value = $("#vApellido").textContent.trim();
        $("#fEmail").value = $("#vEmail").textContent.trim();
        $("#fTelefono").value = $("#vTelefono").textContent.trim();
        $("#fCiudad").value = $("#vCiudad").textContent.trim();
        $("#fInstagram").value = $("#vInstagram").textContent.trim();
      }
      loadFormFromView();
      
      function toggleEdit(on) {
        view.classList.toggle("d-none", on);
        form.classList.toggle("d-none", !on);
        btnCancel.classList.toggle("d-none", !on);
        btnEdit.classList.toggle("d-none", on);
      }
      
      btnEdit.addEventListener("click", () => { loadFormFromView(); toggleEdit(true); });
      btnCancel.addEventListener("click", () => toggleEdit(false));
      btnCancel2.addEventListener("click", () => toggleEdit(false));
      
      // Guardar (mock): vuelca valores del form a la vista
      form.addEventListener("submit", (e) => {
        e.preventDefault();
        if (!form.checkValidity()) { form.classList.add('was-validated'); return; }
        $("#vNombre").textContent = $("#fNombre").value;
        $("#vApellido").textContent = $("#fApellido").value;
        $("#vEmail").textContent = $("#fEmail").value;
        $("#vTelefono").textContent = $("#fTelefono").value || "—";
        $("#vCiudad").textContent = $("#fCiudad").value || "—";
        $("#vInstagram").textContent = $("#fInstagram").value || "—";
        toggleEdit(false);
      });
      
      // Avatar: preview + quitar
      const avatarInput = $("#avatarInput");
      const avatarImg = $("#avatarImg");
      const btnRemoveAvatar = $("#btnRemoveAvatar");
      avatarInput.addEventListener("change", (ev) => {
        const file = ev.target.files?.[0];
        if (!file) return;
        const url = URL.createObjectURL(file);
        avatarImg.src = url;
      });
      btnRemoveAvatar.addEventListener("click", () => {
        avatarImg.src = "../img/avatar-placeholder.jpg";
        avatarInput.value = "";
      });
      
      // Cambiar contraseña (demo)
      const passwordForm = $("#passwordForm");
      passwordForm.addEventListener("submit", (e) => {
        e.preventDefault();
        if (!passwordForm.checkValidity()) { passwordForm.classList.add('was-validated'); return; }
        const a = $("#newPass").value, b = $("#newPass2").value;
        if (a !== b) { alert("Las contraseñas no coinciden."); return; }
        // Acá harías fetch('/api/profile/password', { method:'POST', body:... })
        const modal = bootstrap.Modal.getInstance(document.getElementById('modalPassword'));
        modal.hide();
        alert("Contraseña actualizada (demo).");
      });
    </script>
  </body>
</html>
